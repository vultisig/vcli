# DCA Plugin Server Configuration (app-recurring)
#
# IMPORTANT: This file uses kelseyhightower/envconfig which has strict naming rules:
# - Struct field names are concatenated without extra underscores
# - Example: struct field "BlockStorage.Host" becomes BLOCKSTORAGE_HOST (not BLOCK_STORAGE_HOST)
# - Example: struct field "Server.EncryptionSecret" becomes SERVER_ENCRYPTIONSECRET
#
# Mode: "send" for recurring sends, "swap" for DCA swaps
MODE=swap

# ============================================================================
# QUEUE ISOLATION (CRITICAL - DO NOT CHANGE WITHOUT UNDERSTANDING)
# ============================================================================
# The DCA plugin MUST use a separate queue from the verifier worker.
# During plugin install, a 4-party TSS reshare requires:
#   - Verifier Worker on "default_queue"
#   - DCA Worker on "dca_plugin_queue"
#
# If both use the same queue, the DCA worker picks up BOTH reshare tasks,
# causing the install to fail (you'll see two dca-worker-* parties instead
# of one verifier-dev-* and one dca-worker-*).
#
# This MUST match TASK_QUEUE_NAME in dca-worker.env
SERVER_TASKQUEUENAME=dca_plugin_queue
# ============================================================================

# Logging
LOG_FORMAT=text

# Server
SERVER_PORT=8082
SERVER_HOST=0.0.0.0

# Database
POSTGRES_DSN=postgres://vultisig:vultisig@localhost:5432/vultisig-dca?sslmode=disable

# Redis
REDIS_URI=redis://:vultisig@localhost:6379

# Block Storage (MinIO) - envconfig uses BLOCKSTORAGE_ prefix
BLOCKSTORAGE_HOST=http://localhost:9000
BLOCKSTORAGE_REGION=us-east-1
BLOCKSTORAGE_ACCESSKEY=minioadmin
BLOCKSTORAGE_SECRETKEY=minioadmin
BLOCKSTORAGE_BUCKET=vultisig-dca

# Metrics
METRICS_ENABLED=true
METRICS_HOST=0.0.0.0
METRICS_PORT=8181

# Verifier (for auth middleware)
VERIFIER_URL=http://localhost:8080
VERIFIER_TOKEN=

# Vault encryption secret (for policy signature verification)
SERVER_ENCRYPTIONSECRET=devsecret123456789012345678901234
